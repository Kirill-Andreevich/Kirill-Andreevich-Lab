# üåå Homelab IaC: Zen 5 High-Performance Cluster

–≠—Ç–æ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π ¬´–∏–Ω–∂–µ–Ω–µ—Ä–Ω—ã–π –ø–æ–ª–∏–≥–æ–Ω¬ª –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤—ã—Å–æ–∫–æ–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ–π –≥–µ—Ç–µ—Ä–æ–≥–µ–Ω–Ω–æ–π —Å—Ä–µ–¥–æ–π. –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–∞ –Ω–∞ –±–∞–∑–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã **AMD Zen 5** –∏ —É–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ —Å—Ç–µ–∫ **Terraform + Ansible**.

---

## üèóÔ∏è Hardware Stack (Physical Layer)
–ö–ª–∞—Å—Ç–µ—Ä –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–ª—è —Ç—è–∂–µ–ª—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∂–µ–ª–µ–∑–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏:

| Node | OS | CPU | GPU | Role |
| :--- | :--- | :--- | :--- | :--- |
| **Compute-Node** | EndeavourOS | **Ryzen 9 9950X3D** | **RTX 4090** | AI / Heavy Computing |
| **Workstation** | Manjaro | **Ryzen 7 9800X3D** | **RX 9070 XT** | Dev / Workstation |
| **Storage-Node** | TrueNAS SCALE | **Ryzen 7 9700X** | ‚Äî | ZFS NAS / Core Services |

---

## üõ†Ô∏è –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (IaC)

–í —Ä–∞–º–∫–∞—Ö –ø—Ä–æ–µ–∫—Ç–∞ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π:

### 1. –í–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è (Terraform + Libvirt)
*   **Massive Provisioning**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ **10 –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –º–∞—à–∏–Ω** (Ubuntu 24.04) –Ω–∞ –≥–∏–ø–µ—Ä–≤–∏–∑–æ—Ä–µ KVM.
*   **Storage Optimization**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Copy-on-Write (QCOW2) —Å –±–∞–∑–æ–≤—ã–º –æ–±—Ä–∞–∑–æ–º, —á—Ç–æ —ç–∫–æ–Ω–æ–º–∏—Ç ~180–ì–ë –¥–∏—Å–∫–æ–≤–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞.
*   **Cloud-Init Integration**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–æ–±—Ä–æ—Å SSH-–∫–ª—é—á–µ–π –∏ –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–∫–∞ `qemu-guest-agent`.

### 2. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (Ansible)
*   **Dynamic Inventory**: Terraform –Ω–∞ –ª–µ—Ç—É –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç `hosts.ini`, —Å–≤—è–∑—ã–≤–∞—è —Ñ–∏–∑–∏—á–µ—Å–∫–∏–µ —É–∑–ª—ã –∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –í–ú.
*   **Universal Deployment**: –ü–ª–µ–π–±—É–∫–∏ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω—ã –ø–æ–¥ **Arch Linux (Pacman)** –∏ **Debian/Ubuntu (Apt)**.
*   **Docker Automation**: –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ Docker Runtime –Ω–∞ –≤—Å–µ–º –∫–ª–∞—Å—Ç–µ—Ä–µ.

### 3. Observability (GPU & System Monitoring)
–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –≥–ª—É–±–æ–∫–∏–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–æ—Å—Ç–æ—è–Ω–∏—è "–∂–µ–ª–µ–∑–∞":
*   **NVIDIA Stack**: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫ `nvidia_gpu_exporter` –Ω–∞ Compute-Node.
*   **AMD Stack**: –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–±–æ—Ä–∫–∞ `amd-smi-exporter` –∏–∑ **AUR** –Ω–∞ Manjaro.
*   **Service Discovery**: Terraform –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç `targets.json` –¥–ª—è Prometheus, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è—è –Ω–æ–≤—ã–µ –í–ú –≤ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥.

---

## üöÄ –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –®–∞–≥ 1: –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã
```bash
cd terraform && terraform apply -auto-approve
```
*Terraform —Å–æ–∑–¥–∞–µ—Ç 10 –Ω–æ–¥ –∏ –ø—Ä–æ–ø–∏—Å—ã–≤–∞–µ—Ç –∏—Ö IP –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å Ansible –∏ –∫–æ–Ω—Ñ–∏–≥–∏ Prometheus.*

### –®–∞–≥ 2: –ü–æ–ª–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–æ—Ñ—Ç–∞
```bash
cd ../ansible && ansible-playbook -i inventory/hosts.ini playbooks/site.yml
```
*Ansible –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç Docker, —Å–æ–±–∏—Ä–∞–µ—Ç GPU —ç–∫—Å–ø–æ—Ä—Ç–µ—Ä—ã –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç Node Exporter –Ω–∞ –≤—Å–µ—Ö —É–∑–ª–∞—Ö.*

---

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã
*   **–ü–æ–ª–Ω–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è**: –í—Ä–µ–º—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è 10 –Ω–æ–¥ —Å –Ω—É–ª—è –¥–æ —Ä–∞–±–æ—á–µ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ ‚Äî –º–µ–Ω–µ–µ 3 –º–∏–Ω—É—Ç.
*   **–ì–µ—Ç–µ—Ä–æ–≥–µ–Ω–Ω–æ—Å—Ç—å**: –ï–¥–∏–Ω—ã–π –∫–æ–¥ —É–ø—Ä–∞–≤–ª—è–µ—Ç –∏ –¥–µ—Å–∫—Ç–æ–ø–Ω—ã–º Manjaro, –∏ —Å–µ—Ä–≤–µ—Ä–Ω—ã–º Ubuntu, –∏ TrueNAS.
*   **GPU Insights**: –ú–µ—Ç—Ä–∏–∫–∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã, —á–∞—Å—Ç–æ—Ç –∏ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è RTX 4090 –∏ RX 9070 XT –¥–æ—Å—Ç—É–ø–Ω—ã –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.

---
**Status:** ‚úÖ *Infrastructure is Up and Running. Managed by Code.*

---

## üó∫Ô∏è Roadmap: Phase 2 (Enterprise-Grade Scaling)
–î–∞–ª—å–Ω–µ–π—à–µ–µ —Ä–∞–∑–≤–∏—Ç–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –≤ —Å—Ç–æ—Ä–æ–Ω—É –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏ –∏ –ø–æ–ª–Ω–æ–π –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏:

- [ ] **Grafana as Code**: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã—Ö –¥–∞—à–±–æ—Ä–¥–æ–≤ –¥–ª—è NVIDIA/AMD SMI –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π (JSON-provisioning).
- [ ] **High Availability**: –ü–µ—Ä–µ–µ–∑–¥ —Å –æ–¥–∏–Ω–æ—á–Ω–æ–≥–æ Prometheus –Ω–∞ **Thanos** –∏–ª–∏ **VictoriaMetrics** –¥–ª—è –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è –º–µ—Ç—Ä–∏–∫.
- [ ] **Log Management**: –í–Ω–µ–¥—Ä–µ–Ω–∏–µ —Å—Ç–µ–∫–∞ **Loki + Promtail** –¥–ª—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –ª–æ–≥–æ–≤ —Å GPU-–º–µ—Ç—Ä–∏–∫–∞–º–∏ (–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–∞–¥–µ–Ω–∏–π –¥—Ä–∞–π–≤–µ—Ä–æ–≤).
- [ ] **Network Isolation**: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–∞–∑–¥–µ–ª—å–Ω—ã—Ö VLAN –¥–ª—è —Ç—Ä–∞—Ñ–∏–∫–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ Terraform (Libvirt Network isolation).
- [ ] **Alerting**: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ **Alertmanager** —Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏ –≤ Telegram –ø—Ä–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–º –ø–µ—Ä–µ–≥—Ä–µ–≤–µ GPU (>85¬∞C) –∏–ª–∏ –¥–µ–≥—Ä–∞–¥–∞—Ü–∏–∏ ZFS-–ø—É–ª–∞.

---
**Status:** üìì *Phase 1 Complete. Scaling in Progress...*

---

## üß≠ Roadmap: Evolution to Private Cloud

### Phase 2: Orchestration & Advanced Observability (Current Goal)
- [ ] **Kubernetes Cluster (K3s)**: –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –ª–µ–≥–∫–æ–≤–µ—Å–Ω–æ–≥–æ K8s –ø–æ–≤–µ—Ä—Ö 10 —É–∑–ª–æ–≤ Ubuntu —á–µ—Ä–µ–∑ Ansible.
- [ ] **Log Aggregation (Loki + Promtail)**: –ü–µ—Ä–µ—Ö–æ–¥ –æ—Ç –º–µ—Ç—Ä–∏–∫ –∫ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–º—É –∞–Ω–∞–ª–∏–∑—É –ª–æ–≥–æ–≤ (PLG Stack).
- [ ] **Self-hosted CI/CD (GitHub Actions Runner)**: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –≤–æ—Ä–∫–µ—Ä–∞ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø–ª–µ–π–±—É–∫–æ–≤ –ø—Ä–∏ –ø—É—à–µ.
- [ ] **Dynamic DNS & Consul**: –í–Ω–µ–¥—Ä–µ–Ω–∏–µ Service Discovery –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –Ω–æ–≤—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤.

### Phase 3: Infrastructure Mesh & Security
- [ ] **Service Mesh (Istio/Linkerd)**: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç—Ä–∞—Ñ–∏–∫–æ–º –º–µ–∂–¥—É –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞–º–∏ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Å–≤—è–∑–µ–π.
- [ ] **Secrets Management (HashiCorp Vault)**: –í—ã–Ω–æ—Å –≤—Å–µ—Ö –ø–∞—Ä–æ–ª–µ–π –∏ SSH-–∫–ª—é—á–µ–π –∏–∑ –∫–æ–Ω—Ñ–∏–≥–æ–≤ –≤ –∑–∞—â–∏—â–µ–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ.
- [ ] **GitOps Workflow (ArgoCD)**: –ü–µ—Ä–µ—Ö–æ–¥ –∫ –º–æ–¥–µ–ª–∏, –≥–¥–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–ª–∞—Å—Ç–µ—Ä–∞ Kubernetes –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è —Å Git.
- [ ] **Hybrid Networking (Wireguard Mesh)**: –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Ñ–∏–∑–∏—á–µ—Å–∫–∏—Ö –Ω–æ–¥ –∏ –æ–±–ª–∞—á–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤ –≤ –µ–¥–∏–Ω—É—é –∑–∞—â–∏—â–µ–Ω–Ω—É—é L2/L3 —Å–µ—Ç—å.

---
**Status:** ‚öôÔ∏è *Phase 1 (IaC) - Stable | Phase 2 (K8s) - Researching...*
